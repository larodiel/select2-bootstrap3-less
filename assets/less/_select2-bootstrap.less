.select2 {
    &-container,
    &-drop,
    &-search,
    &-search input { 
        .box-sizing(border-box); 
    }

    &-container {
        position: relative;
        display: inline-block;
        /* inline-block for ie7 */
        zoom: 1;
        *display: inline;
        vertical-align: top;
        width: 100%;

        &.select2-drop-above .select2-choice {
            background-color: @input-border-focus;
            border-bottom-color: @input-border;
            .border-radius(0 0 @input-border-radius @input-border-radius);
        }

        &-multi {
            .select2-choices {
                font-size: @font-size-base;
                line-height: @line-height-base;
                color: @gray;
                .border-radius(@input-border-radius);
                background-color: @input-bg;
                border: 1px solid @input-border;
                .transition(~"border linear .2s, box-shadow linear .2s");
                margin: 0;
                padding: 0;
                cursor: text;
                overflow: hidden;
                height: auto !important;
                height: 1%;
                position: relative;
                min-height: 26px;
                li {
                    display: inline-block;
                    list-style: none;
                }
                .select2-search {

                    &-field {
                        white-space: nowrap;
                        margin: 0;
                        padding: 0;

                        input {
                            color: @input-color;
                            min-height: 15px;
                            padding: 5px;
                            margin: 1px 0;
                            outline: 0;
                            border: 0;
                            .box-shadow(none);
                            &.select2-active { background: @input-bg; }
                        }
                    }
                    &-choice {
                        line-height: 13px;
                        padding: 1px 5px;
                        margin: 3px 2px;
                        position: relative;
                    }
                }
            }
            &.select2-container {
                width: 100%;

                &-active .select2-choices {
                    border: 1px solid @input-border-focus;
                    outline: none;
                }

                &-disabled .select2-choices {
                    background-color: @input-bg;
                    background-image: none;
                    border: 1px solid @input-border;
                    cursor: default;

                    .select2-search-choice {
                        background-image: none;
                        background-color: @input-bg;
                        border: 1px solid @input-border;
                        padding: 3px 5px;

                        .select2-search-choice-close {
                            display: none;
                        }
                    }
                }
            }
        }

        &-active {
            .select2-choice,
            .select2-choices {
                border: 1px solid @input-border-focus;
                outline: none;
            }
        }

        .select2-choice {
            display: block;
            width: 100%;
            height: @input-height-base; // Make inputs at least the height of their button counterpart (base line-height + padding + border)
            padding: @padding-base-vertical @padding-base-horizontal;
            font-size: @font-size-base;
            line-height: @line-height-base;
            color: @input-color;
            background-color: @input-bg;
            background-image: none; // Reset unusual Firefox-on-Android default style; see https://github.com/necolas/normalize.css/issues/214
            border: 1px solid @input-border;
            .border-radius(@input-border-radius);
            .transition(~"border-color ease-in-out .15s, box-shadow ease-in-out .15s");

            // Customize the `:focus` state to imitate native WebKit styles.
            .form-control-focus();

            // Placeholder
            .placeholder();

            // Disabled and read-only inputs
            //
            // HTML5 says that controls under a fieldset > legend:first-child won't be
            // disabled if the fieldset is disabled. Due to implementation difficulty, we
            // don't honor that edge case; we style them as disabled anyway.
            &[disabled],
            &[readonly],
            fieldset[disabled] & {
                cursor: @cursor-disabled;
                background-color: @input-bg-disabled;
                .opacity(1); // iOS fix for unreadable disabled content
            }

            // Reset height for `textarea`s
            textarea& {
                height: auto;
            }

            span {
                margin-right: 26px;
                display: block;
                overflow: hidden;
                white-space: nowrap;
                -o-text-overflow: ellipsis;
                -ms-text-overflow: ellipsis;
                text-overflow: ellipsis;
                text-align: left;
            }

            div {
                .border-radius(0 @input-border-radius @input-border-radius 0);
                background-color: @brand-primary;
                border-left: 1px solid @input-border;
                position: absolute;
                right: 0;
                top: 0;
                height: 100%;
                width: 0;
                padding: 4px 12px 0px 4px;
                &:hover {
                    cursor: pointer;
                }
            }

            .select2-arrow {
                background: transparent;
                display: inline-block;
                height: 100%;
                margin-right: 0;
                position: absolute;
                right: 0;
                top: 0;
                vertical-align: middle;
                width: 18px;

                span {
                    display: inline-block;
                    margin-right: 0;
                    margin-top: 10px;
                }
            }
        }

        .disabled {
            div {
                cursor: default;
                &:hover {
                    cursor: default;
                }
                .caret {
                   .opacity(0.3);
                }
            }
        }
        
        .select2-container-disabled .select2-choice {
            background-color: @input-bg;
            background-image: none;
            border: 1px solid @input-border;
            cursor: default;
            
            div {
                background-color: @input-bg;
                background-image: none;
                border-left: 0;
            }
        }        
    }

    &-drop {
        background: @input-bg;
        border: 1px solid @input-border-focus;
        border-top: 0;
        color: @input-color;
        margin-top: -2px;
        position: absolute;
        top: 100%;
        z-index: 9999;
        width: 100%;
        .border-radius(0 0 @input-border-radius @input-border-radius);

        &.select2-drop-above {
            .border-radius(@input-border-radius @input-border-radius 0px 0px);
            margin-top:1px;
            border-top: 1px solid @input-border-focus;
            border-bottom: 0;

            .select2-search input,
            span.add-on {
                margin-top:4px;
            }
        }

        &down-open .select2-choice {
            background-color: @dropdown-link-hover-bg;
            border: 1px solid @input-border-focus;
            border-bottom-color: transparent;
            border-bottom-left-radius:0;
            border-bottom-right-radius:0;
            color: @dropdown-link-hover-color;
            
            &:hover {
                background-color: @dropdown-link-active-bg;
                color: @dropdown-link-active-color;
            }

            div {
                background: transparent;
                border-left: none;
                .caret {
                    border-top: 0;
                    border-bottom: 4px solid @gray-base;
                    content: "";
                }
            }
        }
    }

    &-search {
        white-space: nowrap;
        z-index: 10000;
        width: 100%;
        margin: 0 1.5%;

        input {
            z-index: 5;
            outline: 0;
            width:96%;
            margin:@grid-gutter-width/2 0 0 0;

            &.select2-active {
                @img: url(@SpinnerPath) no-repeat 100%;
                #gradient > .vertical-imgstopped( @img, #fff, 85%, @gray-lighter, 99%);
            }

        }

        span.add-on {
            margin-top: 0;
            padding: 5px 4px 3px 4px;
            position: absolute;
            top: 0px;
            right: 1.5%;
            z-index: 6;
        }
        &-hidden {
            display: block;
            position: absolute;
            left: -10000px;
        }
        &-choice {
            &-close {
                color:inherit;
                display: inline-block;
                font-size: 1em;

                &:hover {
                    //color: inherit;
                }
            }
            div {
                padding: 2px;
                display: inline-block;
            }
        }
    }

    &-default {
        color: @input-bg-disabled;
    }

    &-more-results {
        background: @input-bg;
        display: list-item;
        &.select2-active { background: @input-bg; }
    }

    &-results {
        margin: 4px 2px 4px 0;
        padding: 0 0 0 4px;
        overflow-x: hidden;
        overflow-y: auto;
        max-height: 200px;

        ul.select2-result-sub {
            margin: 0;
            padding-left: 0;

            > li .select2-result-label { padding-left: (@grid-gutter-width/2) }
            ul {
                > li .select2-result-label { padding-left: (@grid-gutter-width/2)*2 }
                ul {
                    > li .select2-result-label { padding-left: (@grid-gutter-width/2)*3 }
                    ul {
                        > li .select2-result-label { padding-left: (@grid-gutter-width/2)*4 }
                        ul {
                            > li .select2-result-label { padding-left: (@grid-gutter-width/2)*5 }
                            ul {
                                > li .select2-result-label { padding-left: (@grid-gutter-width/2)*6 }
                                ul > li .select2-result-label { padding-left: (@grid-gutter-width/2)*7 }
                            }
                        }
                    }
                }
            }
        }

        li {
            list-style: none;

            em {
                background: @gray-lighter;
                font-style: normal;
            }

            &.select2-result-selectable {
                cursor: pointer;
                &:hover,
                &:focus {
                  text-decoration: none;
                  color: @dropdown-link-active-color;
                  background-color: @dropdown-link-active-bg;
                }
            }
            &.select2-result-with-children > .select2-result-label { font-weight: bold; }
        }

        .select2 {
            &-searching,
            &-selection-limit {
                background: @input-bg;
                display: list-item;
            }
            &-result-label {
                padding: 3px 7px 4px;
                margin: 0;
            }
            &-disabled { display: none; }
        }

        &.select2 {
            &-disabled { display: none; }
        }

        .alert {
            margin-top:@grid-gutter-width/2;
            margin-bottom:@grid-gutter-width/2;
            padding: 5px;
        }
    }

    &-result {
        &-selectable .select2-match,
        &-unselectable {
            .select2-match { text-decoration: none; }
            .select2-result-selectable .select2-match { text-decoration: underline; }
        }

        .alert {
            margin: 0 @grid-gutter-width/2;
        }
    }

    &-offscreen {
        position: absolute;
        left: -10000px;
    }

    &-display-none {
        display: none;
    }

    &-hidden-accessible {
        visibility: hidden;
    }
}

#select2-drop-mask {
    .opacity(0);
    border: 0;
    background-color: #fff;
    margin: 0;
    padding: 0;
    position: fixed;
    left: 0;
    top: 0;
    min-height: 100%;
    min-width: 100%;
    height: auto;
    z-index: 9998;
    width: auto;
}

/* Retina-ize icons */
@media only screen and (-webkit-min-device-pixel-ratio: 1.5) {
    .select2-search input,
    .select2-search-choice-close,
    .select2-container .select2-choice abbr,
    .select2-container .select2-choice div b {
        background-image: url(@Select2x2Path) !important;
        background-repeat: no-repeat !important;
        background-size: 60px 40px !important;
    }
    .select2-search input {
        background-position: 100% -21px !important;
    }
}

